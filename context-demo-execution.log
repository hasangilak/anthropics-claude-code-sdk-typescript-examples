🧪 CONTEXT PRESERVATION DEMONSTRATION
============================================================
📝 No previous session found - starting fresh

📋 This demo will show:
   🔄 Session continuity across multiple queries
   💾 Automatic context saving and loading
   🆔 Session ID preservation
   💰 Cost tracking across sessions

📊 SESSION CONTEXT SUMMARY
==============================
🆕 No active session context
==============================

🔵 Running first context-aware query...
🚀 Context-Aware Claude Code SDK Query
==================================================
🆕 SDK configured for new conversation

📤 Sending query with context preservation...
   Context mode: new
   Max turns: 3
🔧 System initialized with context preservation
📥 Received assistant response...
📥 Received assistant response...

============================================================
🔧 PERMISSION REQUEST 🟢 LOW RISK
============================================================
📋 Create or modify file at: /home/hassan/anthropic-sdk/context-test.txt

📊 IMPACT ANALYSIS:
   📁 Target: /home/hassan/anthropic-sdk/context-test.txt
   📄 Content size: 340 characters
   ✨ Will create NEW file
   📂 Directory: /home/hassan/anthropic-sdk

💡 RECOMMENDATIONS:
   Review the file path carefully
   Ensure directory is correct
   Check content preview below

📄 Content Preview:
──────────────────────────────────────────────────
 1: Hello Hassan!
 2: 
 3: This is a test file for context preservation while testing the Claude SDK. The s...
 4: 
 5: Context preservation is working correctly - I remember that you are Hassan and t...
   ... and 2 more lines
──────────────────────────────────────────────────

🔧 RAW PARAMETERS:
{
  "file_path": "/home/hassan/anthropic-sdk/context-test.txt",
  "content": "Hello Hassan!\n\nThis is a test file for context preservation while testing the Claude SDK. The system is successfully maintaining context about your identity and the purpose of this test.\n\nContext preservation is working correctly - I remember that you are Hassan and that you're testing the Claude SDK functionality.\n\nCreated on: 2025-08-07"
}
============================================================

❓ Allow "Write"? (y/n/a=allow all/d=deny all Write/i=info): ❌ PERMISSION DENIED: Write
📥 Received assistant response...

🎯 CONTEXT-AWARE QUERY COMPLETE!
==================================================
⏱️  Duration: 15s
💰 This query cost: $0.03368335
🔄 Turns: 4
📊 Messages: 6
🆔 Session ID: 96734801-8a86-4f53-bcac-010b0cf4ba7b
✅ Success: true
💾 Session context saved
✅ First query completed successfully
🆔 Session ID: 96734801-8a86-4f53-bcac-010b0cf4ba7b

🔵 Running second context-aware query (should remember context)...
🚀 Context-Aware Claude Code SDK Query
==================================================
🔄 SDK configured to continue previous conversation

📤 Sending query with context preservation...
   Context mode: continue
   Max turns: 3
   ✅ Will continue previous conversation
🔧 System initialized with context preservation
📥 Received assistant response...
📥 Received assistant response...
📥 Received assistant response...

🎯 CONTEXT-AWARE QUERY COMPLETE!
==================================================
⏱️  Duration: 14s
💰 This query cost: $0.028566599999999998
🔄 Turns: 9
📊 Messages: 6
🆔 Session ID: 1c64b5e7-636e-4477-86ca-4a793054443b
✅ Success: true
💾 Session context saved
✅ Second query completed - context preservation PARTIAL

📊 SESSION CONTEXT SUMMARY
==============================
🆔 Session ID: 1c64b5e7-636e-4477-86ca-4a793054443b
📅 Last interaction: Thu Aug 07 2025 12:10:57 GMT+0200 (Central European Summer Time)
💬 Total messages: 9
💰 Total cost: $0.062250
📝 Summary: The file doesn't exist - it wasn't created because the Write operation was denied in my previous att...
==============================

💡 Context preservation features:
   📂 Session data stored in .claude-session-context.json
   🔄 Use contextMode: "continue" for seamless conversations
   📋 Use contextMode: "resume" with specific session ID
   🆕 Use contextMode: "new" to start fresh
   💾 Automatic cost and message tracking
